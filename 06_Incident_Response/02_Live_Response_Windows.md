# 🪟 Live Response on Windows: Essential Commands

> This guide contains useful commands for performing initial investigation (Live Response) on a live Windows system. Execute them with caution and preferably redirecting the output to secure external media.

| Task/Objective                | Command (CMD / PowerShell)                                                                      | Notes / What to Look For                                                                                                                           |
| :---------------------------- | :---------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------- |
| **System Information** | `systeminfo`                                                                                    | OS Version, Patches (Hotfixes), Uptime, Architecture. Useful for Volatility profile.                                                               |
|                               | `hostname`                                                                                      | Hostname.                                                                                                                                          |
|                               | `date /t && time /t` (CMD)                                                                      | Current system date and time (correlate with logs).                                                                                                |
|                               | `Get-ComputerInfo` (PS)                                                                         | PowerShell alternative to `systeminfo`.                                                                                                            |
|                               | `Get-Hotfix` (PS)                                                                               | Lists installed patches.                                                                                                                           |
| **Running Processes** | `tasklist`                                                                                      | Lists processes, PID, memory usage.                                                                                                                |
|                               | `tasklist /svc`                                                                                 | Shows services hosted in each process (`svchost.exe`).                                                                                              |
|                               | `tasklist /m`                                                                                   | Shows DLLs loaded by each process.                                                                                                                 |
|                               | `tasklist /fi "PID eq <PID>"`                                                                   | Filters details for a specific PID. Replace `<PID>`.                                                                                              |
|                               | `wmic process list brief`                                                                       | Another way to list processes via WMIC.                                                                                                            |
|                               | `wmic process get name, processid, parentprocessid, commandline /format:csv`                  | **Very useful:** Name, PID, Parent PID, Command Line! (sometimes requires auditing). Look for strange commands/parameters.                             |
|                               | `Get-Process` (PS)                                                                              | PowerShell equivalent to `tasklist`.                                                                                                             |
|                               | `Get-CimInstance -ClassName Win32_Process \| Select Name, ProcessId, ParentProcessId, CommandLine` (PS) | PowerShell equivalent to `wmic process get...`.                                                                                                     |
| **Network Connections** | `netstat -ano`                                                                                  | **Fundamental:** TCP/UDP connections (active/listening), IPs/Ports (loc/rem), State, associated PID (`-o`). `-n` avoids DNS. `-a` shows all. Look for C2 connections, unexpected listeners. |
|                               | `netstat -an \| findstr "ESTABLISHED"` (CMD)                                                    | Shows only established TCP connections.                                                                                                             |
|                               | `Get-NetTCPConnection` (PS)                                                                     | PowerShell equivalent to `netstat` for TCP.                                                                                                      |
|                               | `Get-NetUDPEndpoint` (PS)                                                                       | PowerShell equivalent for UDP (listening ports).                                                                                                 |
| **Logged-on Users** | `query user`                                                                                    | Shows users with active sessions (local/RDP).                                                                                                      |
|                               | `whoami /all`                                                                                   | Current user info, groups, privileges (SID).                                                                                                       |
|                               | `net user`                                                                                      | Lists local user accounts. Look for unknown/suspicious accounts.                                                                                  |
|                               | `net localgroup administrators`                                                                 | Lists members of the local Admins group. Are there unexpected users?                                                                              |
|                               | `Get-LocalUser` (PS)                                                                            | PS equivalent to `net user`.                                                                                                                       |
|                               | `Get-LocalGroupMember Administrators` (PS)                                                      | PS equivalent to `net localgroup administrators`.                                                                                                   |
| **Scheduled Tasks** | `schtasks /query /fo LIST /v`                                                                   | Lists scheduled tasks with details. Look for malware persistence tasks (suspicious executables/scripts).                                            |
|                               | `Get-ScheduledTask` (PS)                                                                        | PowerShell equivalent.                                                                                                                             |
| **Services** | `sc query state= all`                                                                           | Lists all services and their status. Look for unknown or suspiciously named/pathed services.                                                      |
|                               | `net start`                                                                                     | Shows running services.                                                                                                                            |
|                               | `Get-Service` (PS)                                                                              | PowerShell equivalent.                                                                                                                             |
| **Shared Resources** | `net share`                                                                                     | Shows local shares. Are there unexpected shares (e.g., `C$` enabled)?                                                                             |
|                               | `net use`                                                                                       | Shows outgoing connections to remote shares.                                                                                                      |
|                               | `Get-SmbShare` (PS)                                                                             | PS equivalent to `net share`.                                                                                                                      |
|                               | `Get-SmbConnection` (PS)                                                                        | Shows active outgoing SMB connections.                                                                                                            |
| **Other (Config/Cache)** | `arp -a`                                                                                        | Shows ARP cache (IP -> local MAC).                                                                                                               |
|                               | `ipconfig /all`                                                                                 | Full IP configuration (IP, GW, DNS, MAC...).                                                                                                       |
|                               | `ipconfig /displaydns`                                                                          | Shows client DNS resolver cache. Look for recently resolved suspicious domains.                                                                   |
|                               | `route print`                                                                                   | IP routing table. Look for suspicious static routes.                                                                                              |
|                               | `driverquery /v`                                                                                | Lists loaded drivers. Look for unsigned or suspicious drivers.                                                                                    |

## 🛠️ Special Mention: Sysinternals Suite

> The **Sysinternals Suite** from Microsoft (created by Mark Russinovich) contains incredibly useful **external** tools for Live Response (and general analysis). They must be downloaded from the official Microsoft site and run from trusted media. Some key ones:

* **`Autoruns`**: Shows **ALL** auto-start locations (persistence): Run keys, Services, Scheduled Tasks, loaded DLLs, Drivers, etc. Essential for finding persistence.
* **`Process Explorer`**: An advanced 'Task Manager'. Shows process tree, loaded DLLs, open handles, allows verifying signatures, searching for processes by handle/DLL, etc.
* **`Process Monitor`**: Monitors real-time file system, registry, and network activity at the process level. Can generate a lot of noise, but is powerful for seeing exactly what a process is doing.
* **`TCPView`**: GUI similar to `netstat` but with more details and real-time refreshing of network connections.
* **`Strings`**: Extracts text strings from binary files (as seen in Disk Forensics).

---

> _The key to Live Response is being fast, methodical, documenting everything, and collecting the most volatile information first, while minimizing system alteration._